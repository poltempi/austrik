---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { fetchAllPosts } from "../../services/posts";

Astro.response.headers.set('Cache-Control', 'no-store, max-age=0');

const posts = await fetchAllPosts();
---

<BaseLayout title="Latest · Austrik" description="Últimas publicaciones">
  <h1 style="margin-top:0">Latest</h1>
  {posts.length === 0 ? (
    <p>No hay publicaciones recientes.</p>
  ) : (
    <div class="post-grid">
      {posts.map((p) => (
        <a class="post-card" href={`/${p.slug}`}>
          <figure>
            <img src={p.cover_image_url ?? '/demo-cover.svg'} alt={p.title} loading="lazy" onerror="this.onerror=null;this.src='/demo-cover.svg'" />
            <div class="caption">
              <span class="badge">Latest</span>
              <h2 class="title">{p.title}</h2>
              {p.excerpt && <p style="margin:0; color:#e5e7eb; font-size:.9rem;">{p.excerpt}</p>}
            </div>
          </figure>
        </a>
      ))}
    </div>
  )}
</BaseLayout>


